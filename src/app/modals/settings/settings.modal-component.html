<kirby-page-title>Settings</kirby-page-title>

@let error = vm.error();
<kirby-loading-overlay [isLoading]="vm.isLoading()">
    @if (error) {
        <kirby-empty-state
            iconName="warning"
            themeColor="warning"
            title="Unable to load settings"
            [subtitle]="error"
        >
            <button kirby-button (click)="vm.reload()">Retry</button>
        </kirby-empty-state>
    } @else {
        <kirby-section-header>
            <h3 heading>API Tokens</h3>
        </kirby-section-header>
        <kirby-card [hasPadding]="true">
            <kirby-form-field label="Secret Token" [message]="vm.secretTokenField.message()">
                <input kirby-input type="password" [(ngModel)]="vm.secretTokenField" [hasError]="vm.secretTokenField.message() !== null"/>
            </kirby-form-field>
            <kirby-form-field label="Grant Token" [message]="vm.grantTokenField.message()">
                <input kirby-input type="password" [(ngModel)]="vm.grantTokenField" [hasError]="vm.grantTokenField.message() !== null" />
            </kirby-form-field>
        </kirby-card>

        <br/>

        <kirby-section-header>
            <h3 heading>Default Values</h3>
        </kirby-section-header>
        <kirby-card [hasPadding]="true">
            <kirby-form-field label="Customer Group">
                <input kirby-input type="number" [(ngModel)]="vm.defaultCustomerGroupField"/>
            </kirby-form-field>
            <kirby-form-field label="Product Group">
                <input kirby-input type="number" [(ngModel)]="vm.defaultProductGroupField"/>
            </kirby-form-field>
            <kirby-form-field label="Invoice Layout">
                <input kirby-input type="number" [(ngModel)]="vm.defaultLayoutField"/>
            </kirby-form-field>
            <kirby-form-field label="Payment Terms">
                <input kirby-input type="number" [(ngModel)]="vm.defaultPaymentTermsField"/>
            </kirby-form-field>
            <kirby-form-field label="Vat Zone">
                <input kirby-input type="number" [(ngModel)]="vm.defaultVatZoneField"/>
            </kirby-form-field>
        </kirby-card>
    }
</kirby-loading-overlay>

<kirby-modal-footer>
    <button kirby-button [disabled]="vm.unsubmittable()" (click)="vm.submit()">Save</button>
</kirby-modal-footer>